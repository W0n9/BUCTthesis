% This package is used for bachelors' proposal writting for BUCT.
% Modified from BUCTthesis on 
% https://github.com/Miracle0565/buctthesis
%
\ProvidesPackage{buctproposal}[2022/11/23]
\RequirePackage{kvoptions}
\DeclareDefaultOption{\PassOptionsToClass{\CurrentOption}{ctexbook}}
\ProcessKeyvalOptions*
\PassOptionsToPackage{quiet}{xeCJK}

\RequirePackage{
	amsmath,
	geometry,
	fancyhdr,
	graphicx,
	enumitem,
	booktabs,
	siunitx,
	tabularx,
	array,
	caption,
	float,
	pdfpages,
	zhlipsum,
}
\RequirePackage[sort&compress]{gbt7714}
\RequirePackage[version=4]{mhchem}
\RequirePackage{hyperref}

\geometry{%
	a4paper,nomarginpar,
	top = 3cm, bottom = 2.6cm, left = 2.5cm, right = 3cm,
	headheight = 1cm, footskip = 0.6cm,
}
\fancypagestyle{plain}{%
	\fancyhf{}
	\fancyhead[C]{\zihao{-5} 北京化工大学本科毕业设计（论文）开题报告}
	\fancyfoot[C]{\zihao{-5} \thepage}
	\renewcommand\headrulewidth{0.6pt}
	\renewcommand\footrulewidth{0pt}
}
\pagestyle{plain}

\setCJKfamilyfont{hwxk}[AutoFakeBold=2.2]{STXingkai} 
\newcommand\xingkai{\CJKfamily{hwxk}}
\setCJKmainfont{SimSun}[AutoFakeBold,AutoFakeSlant]
\setCJKsansfont{SimHei}[AutoFakeBold]
\setmainfont{Times New Roman}

\linespread{1.5221}
\ctexset{
	section = {%
		name        = {,、},
		number      = \chinese{section},
		format      = \raggedright\bfseries\zihao{-3},
		aftername   = {},
		beforeskip  = 11 pt,
		afterskip   = 11 pt,
		fixskip     = true,
	},
	subsection = {
		format 		={\bfseries\zihao{-4}},
		indent		={2 em},
		beforeskip  = 3 pt,
		afterskip   = 3 pt,
	},
	today  = big,
}
\setlist{%
	leftmargin = 2em,
	nosep,
}
\setlist[enumerate,1]{%
	labelsep = 2pt,
}
\setlist[enumerate,2]{%
	labelsep = 6pt,
}
\setlist[description]{%
	labelsep = 1em,
}
\newcommand{\buct@def@key}[1]{
	\@namedef{#1}##1{\@namedef{@#1}{##1}}
}
\buct@def@key{class}
\buct@def@key{stuid}
\buct@def@key{school}
\buct@def@key{major}
\buct@def@key{supervisor}

\renewcommand{\maketitle}{\begin{titlepage}
		\hypertarget{title}{}
		\pdfbookmark[1]{封面}{title}
		\vspace*{36bp}
		\begin{center}
			{\xingkai\zihao{-0}\ziju{0.07} 北京化工大学}\\[22bp]
			{\xingkai\fontsize{28bp}{40bp}\ziju{-0.1} \@school}\\[22bp]
			{\bfseries\zihao{1} 本科生毕业（设计）论文开题报告}
			\vskip \stretch{1}
			\zihao{3}
			\begin{tabular}{>{\bfseries}l<{：}@{}>{\enspace}l<{\vspace{.2em}}}
				论文题目     & \@title\vspace{44bp}\\
				专\qquad 业 & \@major\\
				所在班级     & \@class\\
				学生姓名     & \@author\\
				学生学号     & \@stuid\\
				导师姓名     & \@supervisor\\
			\end{tabular}
		\vskip \stretch{2}
		{\large\bfseries 日期：\@date}
		\end{center}
	\end{titlepage}
	\cleardoublepage
	\begin{center}
		\sffamily\zihao{3}\textbf{开题报告}
	\end{center}
}
\def\bibname{参考文献}
\renewcommand{\bibsection}{
    \section{\bibname}
}
\setlength{\bibsep}{0pt}
\AtEndDocument{
	\includepdf[pages=-]{lastpage.pdf}
}